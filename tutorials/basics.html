

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Basics &mdash; qucat  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Designing a classical microwave filter" href="filter_design.html" />
    <link rel="prev" title="Tutorials" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            qucat
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing this project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Building-the-circuit-programmatically">Building the circuit programmatically</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Building-a-circuit-with-the-GUI">Building a circuit with the GUI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Hamiltonian,-and-further-analysis-with-QuTiP">Hamiltonian, and further analysis with QuTiP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Calculating-eigenfrequencies,-loss-rates,-anharmonicities-and-cross-Kerr-couplings">Calculating eigenfrequencies, loss-rates, anharmonicities and cross-Kerr couplings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Sweeping-a-parameter">Sweeping a parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Visualizing-a-normal-mode">Visualizing a normal mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="filter_design.html">Designing a classical microwave filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="optomechanics.html">Computing an optomechanical coupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="MMUSC.html">Modelling a distributed multi-mode resonator</a></li>
<li class="toctree-l2"><a class="reference internal" href="tuneable_coupler.html">Understanding a tuneable coupler circuit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../API/index.html">List of functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../report_a_bug.html">Report a bug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devs/index.html">Developer Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">qucat</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Basics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/basics.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<section id="Basics">
<h1>Basics<a class="headerlink" href="#Basics" title="Link to this heading"></a></h1>
<p>In this example we study a typical circuit QED system consisting of a transmon qubit coupled to a resonator. The first step is to import the objects we will be needing from qucat.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qucat</span> <span class="kn">import</span> <span class="n">Network</span><span class="p">,</span><span class="n">GUI</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">R</span>
</pre></div>
</div>
</div>
<p>One should then create a circuit. These are named <code class="docutils literal notranslate"><span class="pre">Qcircuit</span></code>, short for “Quantum circuit”. There are two ways of creating a <code class="docutils literal notranslate"><span class="pre">Qcircuit</span></code>: using the graphical user interface (GUI), or programmatically.</p>
<section id="Building-the-circuit-programmatically">
<h2>Building the circuit programmatically<a class="headerlink" href="#Building-the-circuit-programmatically" title="Link to this heading"></a></h2>
<p>This is done with circuit components created with the functions <code class="docutils literal notranslate"><span class="pre">R</span></code>, <code class="docutils literal notranslate"><span class="pre">L</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">J</span></code> for resistors, inductors, capacitors and junctions respectively. All circuit components take as first two argument integers referring to the negative and positive node of the circuit components. The third argument is either a float giving the component a value, and/or a string which labels the component parameter to be specified later. Doing the latter avoids performing the computationally expensive
initialization of the circuit multiple times when sweeping a parameter.</p>
<p>For example, this code creates a resistor, with negative node 0, and positive node 1, with a resistance we label <code class="docutils literal notranslate"><span class="pre">R_1</span></code>, and a resistance value of 1 M<span class="math notranslate nohighlight">\(\Omega\)</span>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resistor</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">1e6</span><span class="p">,</span><span class="s1">&#39;R_1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To create a <code class="docutils literal notranslate"><span class="pre">Qcircuit</span></code>, we should pass a list of such components to the <code class="docutils literal notranslate"><span class="pre">qucat</span></code> function <code class="docutils literal notranslate"><span class="pre">Network</span></code>. The following code</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cir_prog</span> <span class="o">=</span> <span class="n">Network</span><span class="p">([</span>
<span class="n">C</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">100e-15</span><span class="p">),</span> <span class="c1"># transmon</span>
<span class="n">J</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Lj&#39;</span><span class="p">),</span>
<span class="n">C</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">100e-15</span><span class="p">),</span> <span class="c1"># resonator</span>
<span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">10e-9</span><span class="p">),</span>
<span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1e-15</span><span class="p">),</span> <span class="c1"># coupling capacitor</span>
<span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.5e-15</span><span class="p">),</span> <span class="c1"># ext. coupl. cap.</span>
<span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">)])</span> <span class="c1"># 50 Ohm load</span>
</pre></div>
</div>
</div>
<p>implements the circuit below, where we have indexed the nodes.</p>
<p><img alt="alt text" src="../_images/basic_circuit.png" /></p>
<p>Since we have not specified a value for <span class="math notranslate nohighlight">\(L_j\)</span>, we have to specify it as a keyword in all subsequent functions. This is the most computationally efficient way to perform a parameter sweep.</p>
<p>By default, <strong>junctions are parametrized by their Josephson inductance</strong> <span class="math notranslate nohighlight">\(L_j = \phi_0^2/E_j\)</span> where <span class="math notranslate nohighlight">\(\phi_0 = \hbar/2e\)</span> is the reduced flux quantum, <span class="math notranslate nohighlight">\(\hbar\)</span> Plancks reduced constant and <span class="math notranslate nohighlight">\(e\)</span> the electron charge. and <span class="math notranslate nohighlight">\(E_j\)</span> (in Joules) is the Josephson energy.</p>
</section>
<section id="Building-a-circuit-with-the-GUI">
<h2>Building a circuit with the GUI<a class="headerlink" href="#Building-a-circuit-with-the-GUI" title="Link to this heading"></a></h2>
<p>Alternatively, we can open the GUI to create the circuit through the following code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cir</span> <span class="o">=</span> <span class="n">GUI</span><span class="p">(</span><span class="s1">&#39;circuits/basics.txt&#39;</span><span class="p">,</span> <span class="c1"># location of the circuit file</span>
        <span class="n">edit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># open the GUI to edit the circuit</span>
        <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># plot the circuit after having edited it</span>
        <span class="n">print_network</span><span class="o">=</span><span class="kc">True</span> <span class="c1"># print the network</span>
       <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_basics_14_0.png" src="../_images/tutorials_basics_14_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
C 1 2 C_c=1 fF
C 0 1 100 fF
J 0 1 Lj
C 0 2 100 fF
L 0 2 10 nH
R 0 2 1 MOhm


</pre></div></div>
</div>
<p>All changes made to the circuit are saved automatically to the file <code class="docutils literal notranslate"><span class="pre">circuits/basics.txt</span></code> and when we shut down the editor, the variable <code class="docutils literal notranslate"><span class="pre">cir</span></code> became a <code class="docutils literal notranslate"><span class="pre">Qcircuit</span></code> object, from which further analysis is possible.</p>
<p><strong>Note: by default the junction is parametrized by its josephson inductance</strong></p>
<p>Since we have not specified a value for <span class="math notranslate nohighlight">\(L_j\)</span>, we have to specify it as a keyword in all subsequent functions. This is the most computationally efficient way to perform a parameter sweep.</p>
</section>
<section id="Hamiltonian,-and-further-analysis-with-QuTiP">
<h2>Hamiltonian, and further analysis with QuTiP<a class="headerlink" href="#Hamiltonian,-and-further-analysis-with-QuTiP" title="Link to this heading"></a></h2>
<section id="Generating-a-Hamiltonian">
<h3>Generating a Hamiltonian<a class="headerlink" href="#Generating-a-Hamiltonian" title="Link to this heading"></a></h3>
<p>The Hamiltonian of the circuit, with the non-linearity of the Josephson junctions Taylor-expanded, is given by</p>
<p><span class="math notranslate nohighlight">\(\hat{H} = \sum_{m\in\text{modes}} \hbar \omega_m\hat{a}_m^\dagger\hat{a}_m +\sum_j\sum_{2n\le\text{taylor}}E_j\frac{(-1)^{n+1}}{(2n)!}\left(\frac{\phi_{zpf,m,j}}{\phi_0}(\hat{a}_m^\dagger+\hat{a}_m)\right)^{2n}\)</span></p>
<p>See our technical paper for more details: <a class="reference external" href="https://arxiv.org/pdf/1908.10342.pdf">https://arxiv.org/pdf/1908.10342.pdf</a></p>
<p>In its construction, we have the freedom to choose the set of <code class="docutils literal notranslate"><span class="pre">modes</span></code> to include, the order of the Taylor expansion of the junction potential <code class="docutils literal notranslate"><span class="pre">taylor</span></code>, and the number of excitations of each mode to consider.</p>
<p>The code below generates a Hamiltonian and calculates its eigenenergies</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute hamiltonian (for h=1, so all energies are expressed in frequency units, not angular)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">hamiltonian</span><span class="p">(</span>
    <span class="n">modes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="c1"># Include modes 0 and 1</span>
    <span class="n">taylor</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span><span class="c1"># Taylor the Josephson potential to the power 4</span>
    <span class="n">excitations</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="c1"># Consider 8 excitations in mode 0, 10 for mode 1</span>
    <span class="n">Lj</span> <span class="o">=</span> <span class="mf">8e-9</span><span class="p">)</span><span class="c1"># set any component values that were not fixed when building the circuit</span>

<span class="c1"># QuTiP method which return the eigenergies of the system</span>
<span class="n">ee</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">eigenenergies</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The first transition of the system is</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_transition</span> <span class="o">=</span> <span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># in units of Hertz</span>
<span class="c1"># print this frequency in GHz units</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2"> GHz&quot;</span><span class="o">%</span><span class="p">((</span><span class="n">first_transition</span><span class="p">)</span><span class="o">/</span><span class="mf">1e9</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5.006 GHz
</pre></div></div>
</div>
</section>
<section id="Open-system-dynamics">
<h3>Open-system dynamics<a class="headerlink" href="#Open-system-dynamics" title="Link to this heading"></a></h3>
<p>A more elaborate use of QuTiP would be to compute the dynamics (for example with qutip.mesolve). The Hamiltonian <code class="docutils literal notranslate"><span class="pre">H</span></code> and collapse operators <code class="docutils literal notranslate"><span class="pre">c_ops</span></code> that one should use are generated with the code below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># H is the Hamiltonian</span>
<span class="n">H</span><span class="p">,</span><span class="n">a_m_list</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">hamiltonian</span><span class="p">(</span><span class="n">modes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">taylor</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span><span class="n">excitations</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">Lj</span> <span class="o">=</span> <span class="mf">8e-9</span><span class="p">,</span>
    <span class="n">return_ops</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># with this, we return the annihilation operators of</span>
                        <span class="c1"># the different modes in addition to the Hamiltonian</span>

<span class="c1"># The Hamiltonian should be in angular frequencies for time-dependant simulations</span>
<span class="n">H</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">H</span>

<span class="n">k</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">loss_rates</span><span class="p">(</span><span class="n">Lj</span> <span class="o">=</span> <span class="mf">8e-9</span><span class="p">)</span> <span class="c1"># Calculate loss rates of the different modes</span>

<span class="c1"># c_ops are the collapse operators</span>
<span class="c1"># which should be in angular frequencies for time-dependant simulations</span>
<span class="n">c_ops</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">a_m_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">a_m_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Calculating-eigenfrequencies,-loss-rates,-anharmonicities-and-cross-Kerr-couplings">
<h2>Calculating eigenfrequencies, loss-rates, anharmonicities and cross-Kerr couplings<a class="headerlink" href="#Calculating-eigenfrequencies,-loss-rates,-anharmonicities-and-cross-Kerr-couplings" title="Link to this heading"></a></h2>
<p>QuCAT can also return the parameters of the (already diagonal) Hamiltonian in first-order perturbation theory</p>
<p><span class="math notranslate nohighlight">\(\hat{H} = \sum_m\sum_{n\ne m} (\hbar\omega_m-A_m-\frac{\chi_{mn}}{2})\hat{a}_m^\dagger\hat{a}_m
-\frac{A_m}{2}\hat{a}_m^\dagger\hat{a}_m^\dagger\hat{a}_m\hat{a}_m -\chi_{mn}\hat{a}_m^\dagger\hat{a}_m\hat{a}_n^\dagger\hat{a}_n\)</span></p>
<p>valid for weak anharmonicity <span class="math notranslate nohighlight">\(\chi_{mn},A_m\ll \omega_m\)</span>.</p>
<p>Here</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\omega_m\)</span> are the frequencies of the normal modes of the circuit where all junctions have been replaced with inductors characterized by their Josephson inductance</p></li>
<li><p><span class="math notranslate nohighlight">\(A_m\)</span> is the anharmonicity of mode <span class="math notranslate nohighlight">\(m\)</span>, the difference in frequency of the first two transitions of the mode</p></li>
<li><p><span class="math notranslate nohighlight">\(\chi_{mn}\)</span> is the shift in mode <span class="math notranslate nohighlight">\(m\)</span> that incurs if an excitation is created in mode <span class="math notranslate nohighlight">\(n\)</span></p></li>
</ul>
<p>See our technical paper for more details: <a class="reference external" href="https://arxiv.org/pdf/1908.10342.pdf">https://arxiv.org/pdf/1908.10342.pdf</a></p>
<p>These parameters, together with the loss rate of the modes, are calculated with the functions <code class="docutils literal notranslate"><span class="pre">eigenfrequencies</span></code>, <code class="docutils literal notranslate"><span class="pre">loss_rates</span></code>, <code class="docutils literal notranslate"><span class="pre">anharmonicities</span></code> and <code class="docutils literal notranslate"><span class="pre">kerr</span></code>, which return the specified quantities for each mode <strong>in units of Hertz</strong>, <strong>ordered with increasing mode frequency</strong></p>
<section id="Eigen-frequencies">
<h3>Eigen-frequencies<a class="headerlink" href="#Eigen-frequencies" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cir</span><span class="o">.</span><span class="n">eigenfrequencies</span><span class="p">(</span><span class="n">Lj</span><span class="o">=</span><span class="mf">8e-9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([5.00696407e+09, 5.60042136e+09])
</pre></div></div>
</div>
<p>This will return a list of the normal modes of the circuit, we can see they are seperated in frequency by 600 MHz, but we still do not which corresponds to the transmon, and which to the resonator.</p>
<p>To distinquish the two, we can calculate the anharmonicities of each mode.</p>
</section>
<section id="Anharmonicity">
<h3>Anharmonicity<a class="headerlink" href="#Anharmonicity" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cir</span><span class="o">.</span><span class="n">anharmonicities</span><span class="p">(</span><span class="n">Lj</span><span class="o">=</span><span class="mf">8e-9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([5.82660683e+02, 1.91131054e+08])
</pre></div></div>
</div>
<p>The first (lowest frequency) mode, has a very small anharmonicity, whilst the second, has an anharmonicity of 191 MHz. The highest frequency mode thus corresponds to the transmon.</p>
</section>
<section id="Cross-Kerr-or-dispersive-shift">
<h3>Cross-Kerr or dispersive shift<a class="headerlink" href="#Cross-Kerr-or-dispersive-shift" title="Link to this heading"></a></h3>
<p>In this regime of far detuning in frequency, the two modes will interact through a cross-Kerr or dispersive shift, which quantifies the amount by which one mode will shift if frequency if the other is populated with an excitation.</p>
<p>We can access this by calculating the Kerr parameters <code class="docutils literal notranslate"><span class="pre">K</span></code>. In this two dimensional array, the components <code class="docutils literal notranslate"><span class="pre">K[i,j]</span></code> correspond to the cross-Kerr interaction of mode <code class="docutils literal notranslate"><span class="pre">i</span></code> with mode <code class="docutils literal notranslate"><span class="pre">j</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">kerr</span><span class="p">(</span><span class="n">Lj</span><span class="o">=</span><span class="mf">8e-9</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2"> kHz&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
667.43 kHz
</pre></div></div>
</div>
<p>From the above, we have found that the cross-Kerr interaction between these two modes is of about 667 kHz.</p>
<p>This should correspond to <span class="math notranslate nohighlight">\(2\sqrt{A_0A_1}\)</span> where <span class="math notranslate nohighlight">\(A_i\)</span> is the anharmonicity of mode <span class="math notranslate nohighlight">\(i\)</span>. Let’s check that:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">anharmonicities</span><span class="p">(</span><span class="n">Lj</span><span class="o">=</span><span class="mf">8e-9</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2"> kHz&quot;</span><span class="o">%</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">1e3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
667.43 kHz
</pre></div></div>
</div>
</section>
<section id="Loss-rates">
<h3>Loss rates<a class="headerlink" href="#Loss-rates" title="Link to this heading"></a></h3>
<p>In the studied circuit, the only resistor is located in the resonator. We would thus expect the resonator to be more lossy than the transmon.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cir</span><span class="o">.</span><span class="n">loss_rates</span><span class="p">(</span><span class="n">Lj</span><span class="o">=</span><span class="mf">8e-9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([1572104.84520218,    3841.15992345])
</pre></div></div>
</div>
<p>All these quantities are always ordered with increasing mode frequency, so the second element of the array corresponds to the loss rate of the transmon mode.</p>
</section>
<section id="T_1-times">
<h3><span class="math notranslate nohighlight">\(T_1\)</span> times<a class="headerlink" href="#T_1-times" title="Link to this heading"></a></h3>
<p>When converting these rates to <span class="math notranslate nohighlight">\(T_1\)</span> times, one should not forget the <span class="math notranslate nohighlight">\(2\pi\)</span> in the conversion</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">cir</span><span class="o">.</span><span class="n">loss_rates</span><span class="p">(</span><span class="n">Lj</span><span class="o">=</span><span class="mf">8e-9</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1.0123685e-07 4.1434084e-05]
</pre></div></div>
</div>
<p>All these relevant parameters (frequency, dissipation, anharmonicity and Kerr parameters) can be returned in this order using a single function</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cir</span><span class="o">.</span><span class="n">f_k_A_chi</span><span class="p">(</span><span class="n">Lj</span> <span class="o">=</span> <span class="mf">8e-9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([5.00696407e+09, 5.60042136e+09]),
 array([1572104.84520218,    3841.15992345]),
 array([5.82660683e+02, 1.91131054e+08]),
 array([[5.82660683e+02, 6.67426551e+05],
        [6.67426551e+05, 1.91131054e+08]]))
</pre></div></div>
</div>
<p>Using the option <code class="docutils literal notranslate"><span class="pre">pretty_print</span> <span class="pre">=</span> <span class="pre">True</span></code> a more readable summary can be printed</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">chi</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">f_k_A_chi</span><span class="p">(</span><span class="n">pretty_print</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Lj</span> <span class="o">=</span> <span class="mf">8e-9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         mode |       freq.  |       diss.  |       anha.  |
            0 |     5.01 GHz |     1.57 MHz |       583 Hz |
            1 |      5.6 GHz |     3.84 kHz |      191 MHz |

Kerr coefficients (diagonal = Kerr, off-diagonal = cross-Kerr)
         mode |         0    |         1    |
            0 |       583 Hz |              |
            1 |      667 kHz |      191 MHz |

</pre></div></div>
</div>
</section>
</section>
<section id="Sweeping-a-parameter">
<h2>Sweeping a parameter<a class="headerlink" href="#Sweeping-a-parameter" title="Link to this heading"></a></h2>
<p>The most computationally expensive part of the analysis is performed upon initializing the circuit. To avoid doing this, we can enter a symbolic value for a component.</p>
<p>In this example, we have provided a label <code class="docutils literal notranslate"><span class="pre">Lj</span></code> for the Josephson inductance. Its value has been passed as a keyword argument all function calls (<code class="docutils literal notranslate"><span class="pre">Lj=8e-9</span></code>) but we can also specify an array of values as done below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># array of values for the josephson inductance</span>
<span class="n">Lj_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">8e-9</span><span class="p">,</span><span class="mf">12e-9</span><span class="p">,</span><span class="mi">101</span><span class="p">)</span>

<span class="c1"># Eigen-frequencies of the system:</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">eigenfrequencies</span><span class="p">(</span><span class="n">Lj</span><span class="o">=</span><span class="n">Lj_list</span><span class="p">)</span>

<span class="c1"># plot first mode</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Lj_list</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span><span class="n">freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e9</span><span class="p">)</span>

<span class="c1"># plot second mode</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Lj_list</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span><span class="n">freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e9</span><span class="p">)</span>

<span class="c1"># Add labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L_J (nH)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Normal mode frequency (GHz)&#39;</span><span class="p">)</span>

<span class="c1"># show the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\Anaconda3\lib\site-packages\numpy\core\numeric.py:538: ComplexWarning: Casting complex values to real discards the imaginary part
  return array(a, dtype, copy=False, order=order)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_basics_51_1.png" src="../_images/tutorials_basics_51_1.png" />
</div>
</div>
</section>
<section id="Visualizing-a-normal-mode">
<h2>Visualizing a normal mode<a class="headerlink" href="#Visualizing-a-normal-mode" title="Link to this heading"></a></h2>
<p>A better physical understanding of the circuit can be obtained by visualizing the flow of current through the circuit components for a given normal mode.</p>
<p>This is done through the <code class="docutils literal notranslate"><span class="pre">show_normal_mode</span></code> function as shown below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cir</span><span class="o">.</span><span class="n">show_normal_mode</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">quantity</span><span class="o">=</span><span class="s1">&#39;current&#39;</span><span class="p">,</span> <span class="n">Lj</span> <span class="o">=</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="n">cir</span><span class="o">.</span><span class="n">show_normal_mode</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">quantity</span><span class="o">=</span><span class="s1">&#39;current&#39;</span><span class="p">,</span> <span class="n">Lj</span> <span class="o">=</span> <span class="mf">10e-9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_basics_54_0.png" src="../_images/tutorials_basics_54_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_basics_54_1.png" src="../_images/tutorials_basics_54_1.png" />
</div>
</div>
<p>The annotation corresponds to the complex amplitude, or phasor, of current across the component, if the mode was populated with a single photon amplitude coherent state. The absolute value of this annotation thus corresponds to the contribution of a mode to the zero-point fluctuations of the given quantity across the component. The direction of the arrows indicates what direction we take for 0 phase for that component.</p>
<p>We see above that the symmetry on each side of the coupling capacitor is changing between the modes, the above is called the anti-symmetric mode, with a voltage build-up on either side of the coupling capacitor leading to a larger current going through it. Mode 1 is the anti-symmetric mode.</p>
<p>Through the keyword <code class="docutils literal notranslate"><span class="pre">quantity</span></code>, one can alternatively plot voltage, flux, or charge.</p>
<p>The values in these annotations can also be accessed programmatically:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cir</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="s1">&#39;C_c&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">zpf</span><span class="p">(</span><span class="n">mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">quantity</span> <span class="o">=</span> <span class="s1">&#39;current&#39;</span><span class="p">,</span><span class="n">Lj</span> <span class="o">=</span> <span class="mf">10e-9</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1.7816247236867328e-10-1.4226021802836471e-12j)
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="filter_design.html" class="btn btn-neutral float-right" title="Designing a classical microwave filter" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Mario Gely.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>